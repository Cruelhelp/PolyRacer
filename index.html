<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>POLY RACE - Multiplayer Typing Racing</title>
  <meta name="description" content="Race against players worldwide in this fast-paced multiplayer typing game. Type to move, compete in real-time, and become the fastest typist!">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    /* POLY RACE - Minimalistic Neon Void Landing */

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* Custom Poly Scrollbar */
    ::-webkit-scrollbar {
      width: 0px;
      height: 0px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: transparent;
    }

    /* Firefox */
    * {
      scrollbar-width: none;
      scrollbar-color: transparent transparent;
    }

    :root {
      --cyan: #00ffff;
      --magenta: #ff00ff;
      --void: #000000;
      --dark: #0a0a0f;
    }

    html, body {
      width: 100%;
      height: 100%;
      font-family: 'Orbitron', sans-serif;
      background: var(--void);
      color: #fff;
      overflow-x: hidden;
    }

    /* Hero Section */
    .hero {
      position: relative;
      width: 100%;
      height: 100vh;
      display: flex;
      align-items: center;
      overflow: hidden;
      background: radial-gradient(ellipse at center, #0a0a0f 0%, #000000 100%);
    }

    #wireframe-bg-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      opacity: 0.4;
    }

    .hero-content {
      position: relative;
      z-index: 10;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 3rem;
      width: 100%;
    }

    .hero-title {
      margin-bottom: 1.5rem;
    }

    .title-line {
      display: block;
      font-size: 8rem;
      font-weight: 900;
      line-height: 0.85;
      letter-spacing: 15px;
      text-transform: uppercase;
      color: #fff;
      text-shadow:
        0 0 40px var(--cyan),
        0 0 80px var(--cyan),
        0 0 120px rgba(0, 255, 255, 0.3);
    }

    .hero-subtitle {
      font-size: 1.1rem;
      color: rgba(255, 255, 255, 0.5);
      letter-spacing: 6px;
      margin-bottom: 3rem;
      font-weight: 400;
      text-transform: uppercase;
    }

    .hero-cta {
      margin-bottom: 2rem;
    }

    .btn {
      display: inline-block;
      padding: 1rem 3rem;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      font-weight: 600;
      letter-spacing: 3px;
      text-decoration: none;
      transition: all 0.3s ease;
      border: 1px solid;
      background: transparent;
      cursor: pointer;
    }

    .btn-primary {
      border-color: var(--cyan);
      color: var(--cyan);
      text-shadow: 0 0 10px var(--cyan);
    }

    .btn-primary:hover {
      background: rgba(0, 255, 255, 0.1);
      box-shadow: 0 0 30px rgba(0, 255, 255, 0.4);
      transform: translateX(5px);
    }

    .player-count {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.4);
      letter-spacing: 2px;
      font-weight: 300;
    }

    .player-count span {
      color: var(--cyan);
      font-weight: 600;
    }

    /* Info Sections */
    .info-section {
      background: #000;
      padding: 60px 20px;
      border-top: 1px solid rgba(0, 255, 255, 0.1);
    }

    .info-container {
      max-width: 900px;
      margin: 0 auto;
      text-align: center;
    }

    .info-icon {
      margin-bottom: 20px;
      display: flex;
      justify-content: center;
    }

    .info-icon svg {
      filter: drop-shadow(0 0 10px currentColor);
    }

    .info-title {
      font-size: 1.8rem;
      font-weight: 800;
      letter-spacing: 8px;
      color: #fff;
      margin-bottom: 15px;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
    }

    .info-subtitle {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.4);
      letter-spacing: 2px;
      margin-bottom: 40px;
      font-weight: 300;
    }

    .info-text {
      font-size: 0.95rem;
      color: rgba(255, 255, 255, 0.6);
      letter-spacing: 2px;
      line-height: 1.6;
      font-weight: 300;
    }

    /* How to Play Grid */
    .how-to-play-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 40px;
      margin-top: 40px;
    }

    .play-step {
      text-align: center;
    }

    .step-icon {
      margin-bottom: 20px;
      display: flex;
      justify-content: center;
    }

    .step-icon svg {
      filter: drop-shadow(0 0 10px currentColor);
      transition: transform 0.3s ease;
    }

    .play-step:hover .step-icon svg {
      transform: scale(1.1);
    }

    .step-title {
      font-size: 1.2rem;
      font-weight: 700;
      letter-spacing: 4px;
      color: #fff;
      margin-bottom: 12px;
      text-shadow: 0 0 15px rgba(0, 255, 255, 0.4);
    }

    .step-text {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.5);
      letter-spacing: 1px;
      line-height: 1.5;
      font-weight: 300;
    }

    /* Leaderboard Section */
    .leaderboard-section {
      background: radial-gradient(ellipse at center, #0a0a0f 0%, #000000 100%);
      padding: 80px 20px;
    }

    .leaderboard-container {
      max-width: 800px;
    }

    .leaderboard-table {
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(0, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
      box-shadow: 0 0 40px rgba(0, 255, 255, 0.1);
    }

    .leaderboard-header {
      display: grid;
      grid-template-columns: 80px 1fr 100px 100px;
      gap: 20px;
      padding: 20px 30px;
      background: rgba(0, 255, 255, 0.05);
      border-bottom: 2px solid rgba(0, 255, 255, 0.3);
    }

    .lb-col {
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 3px;
      color: rgba(0, 255, 255, 0.8);
      text-transform: uppercase;
    }

    .leaderboard-entries {
      max-height: 500px;
      overflow-y: auto;
    }

    .leaderboard-entry {
      display: grid;
      grid-template-columns: 80px 1fr 100px 100px;
      gap: 20px;
      padding: 18px 30px;
      border-bottom: 1px solid rgba(0, 255, 255, 0.05);
      transition: all 0.3s ease;
      position: relative;
    }

    .leaderboard-entry::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: transparent;
      transition: background 0.3s ease;
    }

    .leaderboard-entry:hover {
      background: rgba(0, 255, 255, 0.03);
    }

    .leaderboard-entry:hover::before {
      background: linear-gradient(180deg, var(--cyan), var(--magenta));
      box-shadow: 0 0 10px var(--cyan);
    }

    .lb-gold::before {
      background: linear-gradient(180deg, #FFD700, #FFA500);
      box-shadow: 0 0 15px #FFD700;
    }

    .lb-silver::before {
      background: linear-gradient(180deg, #C0C0C0, #A8A8A8);
      box-shadow: 0 0 15px #C0C0C0;
    }

    .lb-bronze::before {
      background: linear-gradient(180deg, #CD7F32, #B8860B);
      box-shadow: 0 0 15px #CD7F32;
    }

    .lb-gold:hover {
      background: rgba(255, 215, 0, 0.05);
    }

    .lb-silver:hover {
      background: rgba(192, 192, 192, 0.05);
    }

    .lb-bronze:hover {
      background: rgba(205, 127, 50, 0.05);
    }

    .leaderboard-entry .lb-col {
      font-size: 0.9rem;
      font-weight: 400;
      letter-spacing: 1px;
      color: rgba(255, 255, 255, 0.8);
      display: flex;
      align-items: center;
    }

    .lb-rank {
      justify-content: center;
      font-weight: 600;
      color: rgba(0, 255, 255, 0.6);
    }

    .lb-player {
      font-weight: 500;
      color: #fff;
    }

    .lb-wins, .lb-wpm {
      justify-content: center;
      font-family: 'Courier New', monospace;
      color: rgba(0, 255, 255, 0.8);
    }

    .rank-icon {
      filter: drop-shadow(0 0 8px currentColor);
    }

    .lb-gold .rank-icon {
      filter: drop-shadow(0 0 10px #FFD700);
    }

    .lb-silver .rank-icon {
      filter: drop-shadow(0 0 10px #C0C0C0);
    }

    .lb-bronze .rank-icon {
      filter: drop-shadow(0 0 10px #CD7F32);
    }

    /* Footer */
    .footer {
      background: #000;
      padding: 40px 20px;
      border-top: 2px solid rgba(0, 255, 255, 0.2);
    }

    .footer-content {
      max-width: 600px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .footer-text {
      text-align: center;
    }

    .footer-text p {
      margin: 5px 0;
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.5);
      letter-spacing: 2px;
    }

    .footer-author {
      color: #00ffff;
      font-weight: 600;
      text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    }

    .footer-year {
      font-size: 0.75rem !important;
      color: rgba(255, 255, 255, 0.3) !important;
    }

    /* Fade Transition Overlay */
    #fade-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      opacity: 0;
      pointer-events: none;
      z-index: 9999;
      transition: opacity 0.8s ease-in-out;
    }

    #fade-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    /* Responsive - Mobile First */
    @media (max-width: 768px) {
      html, body {
        overflow-x: hidden;
      }

      .hero {
        min-height: 100vh;
        padding: 20px 0;
      }

      .hero-content {
        padding: 0 1rem;
      }

      .title-line {
        font-size: 3rem;
        letter-spacing: 6px;
      }

      .hero-subtitle {
        font-size: 0.8rem;
        letter-spacing: 3px;
        margin-bottom: 2rem;
      }

      .btn-primary {
        padding: 1rem 2rem;
        font-size: 0.85rem;
        width: 100%;
        max-width: 300px;
      }

      .player-count {
        font-size: 0.75rem;
      }

      .info-section {
        padding: 40px 15px;
      }

      .how-to-play-grid {
        grid-template-columns: 1fr;
        gap: 25px;
      }

      .play-step {
        padding: 0 10px;
      }

      .step-icon svg {
        width: 40px;
        height: 40px;
      }

      .step-title {
        font-size: 1rem;
        letter-spacing: 3px;
      }

      .step-text {
        font-size: 0.8rem;
      }

      .leaderboard-container {
        padding: 0 10px;
      }

      .leaderboard-header,
      .leaderboard-entry {
        grid-template-columns: 50px 1fr 60px 60px;
        gap: 8px;
        padding: 12px 10px;
      }

      .lb-col {
        font-size: 0.6rem;
        letter-spacing: 1px;
      }

      .leaderboard-entry .lb-col {
        font-size: 0.75rem;
      }

      .rank-icon {
        width: 18px !important;
        height: 18px !important;
      }

      .info-title {
        font-size: 1.3rem;
        letter-spacing: 4px;
      }

      .info-subtitle {
        font-size: 0.75rem;
      }

      .footer {
        padding: 30px 15px;
      }

      .footer-text p {
        font-size: 0.75rem;
      }
    }

    @media (max-width: 480px) {
      .title-line {
        font-size: 2.5rem;
        letter-spacing: 4px;
      }

      .hero-subtitle {
        font-size: 0.7rem;
        letter-spacing: 2px;
      }

      .btn-primary {
        padding: 0.9rem 1.5rem;
        font-size: 0.8rem;
      }

      .info-title {
        font-size: 1.1rem;
        letter-spacing: 3px;
      }

      .leaderboard-header,
      .leaderboard-entry {
        grid-template-columns: 40px 1fr 50px 50px;
        gap: 6px;
        padding: 10px 8px;
      }

      .lb-col {
        font-size: 0.55rem;
      }

      .leaderboard-entry .lb-col {
        font-size: 0.7rem;
      }
    }
  </style>
</head>
<body>
  <!-- Fade Transition Overlay -->
  <div id="fade-overlay"></div>

  <!-- Hero Section -->
  <section class="hero">
    <div id="wireframe-bg-container"></div>
    <div class="hero-content">
      <h1 class="hero-title">
        <span class="title-line">POLY</span>
        <span class="title-line">RACE</span>
      </h1>
      <p class="hero-subtitle">Type. Race. Win.</p>
      <div class="hero-cta">
        <a href="#" class="btn btn-primary" id="playBtn">PLAY</a>
      </div>
      <div class="player-count">
        <span id="players-online">...</span> players online
      </div>
    </div>
  </section>

  <!-- How to Play Section -->
  <section class="info-section" id="how-to-play">
    <div class="info-container">
      <h2 class="info-title">HOW TO PLAY</h2>
      <div class="how-to-play-grid">
        <div class="play-step">
          <div class="step-icon">
            <svg viewBox="0 0 60 60" width="50" height="50">
              <!-- Keyboard icon -->
              <rect x="10" y="20" width="40" height="25" rx="2" fill="none" stroke="#00ffff" stroke-width="2"/>
              <rect x="15" y="25" width="6" height="5" fill="#00ffff" opacity="0.3"/>
              <rect x="23" y="25" width="6" height="5" fill="#00ffff" opacity="0.3"/>
              <rect x="31" y="25" width="6" height="5" fill="#00ffff" opacity="0.3"/>
              <rect x="39" y="25" width="6" height="5" fill="#00ffff" opacity="0.3"/>
              <rect x="15" y="32" width="6" height="5" fill="#00ffff"/>
              <rect x="23" y="32" width="14" height="5" fill="#00ffff"/>
              <rect x="39" y="32" width="6" height="5" fill="#00ffff"/>
            </svg>
          </div>
          <h3 class="step-title">TYPE</h3>
          <p class="step-text">Type the letters shown above your character to move forward</p>
        </div>

        <div class="play-step">
          <div class="step-icon">
            <svg viewBox="0 0 60 60" width="50" height="50">
              <!-- Speed icon -->
              <path d="M 15 30 L 25 20 L 35 30 L 30 30 L 30 40 L 20 40 L 20 30 Z" fill="none" stroke="#ff00ff" stroke-width="2"/>
              <path d="M 35 25 L 45 15 L 55 25 L 50 25 L 50 35 L 40 35 L 40 25 Z" fill="none" stroke="#ff00ff" stroke-width="2"/>
              <line x1="10" y1="45" x2="30" y2="45" stroke="#ff00ff" stroke-width="2"/>
              <line x1="35" y1="40" x2="50" y2="40" stroke="#ff00ff" stroke-width="2"/>
            </svg>
          </div>
          <h3 class="step-title">RACE</h3>
          <p class="step-text">Faster typing equals faster speed. Race against other players</p>
        </div>

        <div class="play-step">
          <div class="step-icon">
            <svg viewBox="0 0 60 60" width="50" height="50">
              <!-- Trophy icon -->
              <path d="M 20 15 L 25 10 L 35 10 L 40 15 L 35 20 L 35 30 L 33 35 L 27 35 L 25 30 L 25 20 Z" fill="none" stroke="#FFD700" stroke-width="2"/>
              <ellipse cx="30" cy="37" rx="8" ry="3" fill="none" stroke="#FFD700" stroke-width="2"/>
              <rect x="25" y="37" width="10" height="8" fill="none" stroke="#FFD700" stroke-width="2"/>
              <line x1="15" y1="15" x2="15" y2="22" stroke="#FFD700" stroke-width="2"/>
              <line x1="45" y1="15" x2="45" y2="22" stroke="#FFD700" stroke-width="2"/>
              <path d="M 15 15 Q 10 15 10 20 Q 10 25 15 25" fill="none" stroke="#FFD700" stroke-width="2"/>
              <path d="M 45 15 Q 50 15 50 20 Q 50 25 45 25" fill="none" stroke="#FFD700" stroke-width="2"/>
            </svg>
          </div>
          <h3 class="step-title">WIN</h3>
          <p class="step-text">Be the first to cross the finish line and claim victory</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Leaderboard Section -->
  <section class="info-section leaderboard-section" id="leaderboard">
    <div class="info-container leaderboard-container">
      <h2 class="info-title">LEADERBOARD</h2>
      <p class="info-subtitle">Top racers of all time</p>
      
      <div class="leaderboard-table">
        <div class="leaderboard-header">
          <div class="lb-col lb-rank">RANK</div>
          <div class="lb-col lb-player">PLAYER</div>
          <div class="lb-col lb-wins">WINS</div>
          <div class="lb-col lb-wpm">WPM</div>
        </div>
        
        <div id="leaderboard-entries" class="leaderboard-entries">
          <!-- Placeholder entries - will be replaced by backend data -->
          <div class="leaderboard-entry lb-gold">
            <div class="lb-col lb-rank">
              <svg viewBox="0 0 30 30" width="24" height="24" class="rank-icon">
                <polygon points="15,3 18,12 27,12 20,17 23,26 15,20 7,26 10,17 3,12 12,12" fill="#FFD700"/>
              </svg>
            </div>
            <div class="lb-col lb-player">Loading...</div>
            <div class="lb-col lb-wins">---</div>
            <div class="lb-col lb-wpm">---</div>
          </div>

          <div class="leaderboard-entry lb-silver">
            <div class="lb-col lb-rank">
              <svg viewBox="0 0 30 30" width="24" height="24" class="rank-icon">
                <polygon points="15,3 18,12 27,12 20,17 23,26 15,20 7,26 10,17 3,12 12,12" fill="#C0C0C0"/>
              </svg>
            </div>
            <div class="lb-col lb-player">Loading...</div>
            <div class="lb-col lb-wins">---</div>
            <div class="lb-col lb-wpm">---</div>
          </div>

          <div class="leaderboard-entry lb-bronze">
            <div class="lb-col lb-rank">
              <svg viewBox="0 0 30 30" width="24" height="24" class="rank-icon">
                <polygon points="15,3 18,12 27,12 20,17 23,26 15,20 7,26 10,17 3,12 12,12" fill="#CD7F32"/>
              </svg>
            </div>
            <div class="lb-col lb-player">Loading...</div>
            <div class="lb-col lb-wins">---</div>
            <div class="lb-col lb-wpm">---</div>
          </div>

          <div class="leaderboard-entry">
            <div class="lb-col lb-rank">4</div>
            <div class="lb-col lb-player">Loading...</div>
            <div class="lb-col lb-wins">---</div>
            <div class="lb-col lb-wpm">---</div>
          </div>

          <div class="leaderboard-entry">
            <div class="lb-col lb-rank">5</div>
            <div class="lb-col lb-player">Loading...</div>
            <div class="lb-col lb-wins">---</div>
            <div class="lb-col lb-wpm">---</div>
          </div>

          <div class="leaderboard-entry">
            <div class="lb-col lb-rank">6</div>
            <div class="lb-col lb-player">Loading...</div>
            <div class="lb-col lb-wins">---</div>
            <div class="lb-col lb-wpm">---</div>
          </div>

          <div class="leaderboard-entry">
            <div class="lb-col lb-rank">7</div>
            <div class="lb-col lb-player">Loading...</div>
            <div class="lb-col lb-wins">---</div>
            <div class="lb-col lb-wpm">---</div>
          </div>

          <div class="leaderboard-entry">
            <div class="lb-col lb-rank">8</div>
            <div class="lb-col lb-player">Loading...</div>
            <div class="lb-col lb-wins">---</div>
            <div class="lb-col lb-wpm">---</div>
          </div>

          <div class="leaderboard-entry">
            <div class="lb-col lb-rank">9</div>
            <div class="lb-col lb-player">Loading...</div>
            <div class="lb-col lb-wins">---</div>
            <div class="lb-col lb-wpm">---</div>
          </div>

          <div class="leaderboard-entry">
            <div class="lb-col lb-rank">10</div>
            <div class="lb-col lb-player">Loading...</div>
            <div class="lb-col lb-wins">---</div>
            <div class="lb-col lb-wpm">---</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-text">
        <p>Created by <span class="footer-author">Ruel McNeil</span></p>
        <p class="footer-year">Â© 2025 POLY RACE</p>
      </div>
    </div>
  </footer>

  <script>
    /**
     * POLY RACE - Animated Wireframe Background
     * Racing runners with floating letters
     */

    class WireframeBackground {
      constructor(containerId) {
        this.container = document.getElementById(containerId);
        if (!this.container) return;

        this.canvas = document.createElement('canvas');
        this.ctx = this.canvas.getContext('2d');
        this.container.appendChild(this.canvas);

        this.canvas.style.position = 'absolute';
        this.canvas.style.top = '0';
        this.canvas.style.left = '0';
        this.canvas.style.width = '100%';
        this.canvas.style.height = '100%';
        this.canvas.style.pointerEvents = 'none';
        this.canvas.style.zIndex = '1';

        this.runners = [];
        this.letters = [];
        this.particles = [];

        this.resize();
        window.addEventListener('resize', () => this.resize());

        this.init();
        this.animate();
      }

      resize() {
        this.width = this.container.offsetWidth;
        this.height = this.container.offsetHeight;
        this.canvas.width = this.width;
        this.canvas.height = this.height;
      }

      init() {
        // Create runners with varied starting positions
        for (let i = 0; i < 3; i++) {
          this.runners.push(new PolyRunner(
            Math.random() * (this.width * 0.3), // Start on left side
            (this.height / 4) * (i + 1) + 50,
            ['#00ffff', '#ff00ff', '#00ff88'][i]
          ));
        }
      }

      animate() {
        this.ctx.clearRect(0, 0, this.width, this.height);

        // Draw finish line on the right
        this.drawFinishLine();

        // Update and draw runners
        this.runners.forEach(runner => {
          runner.update(this.width);
          runner.draw(this.ctx);
        });

        requestAnimationFrame(() => this.animate());
      }

      drawFinishLine() {
        const x = this.width - 80;
        const lineHeight = this.height;
        const stripeWidth = 20;
        const stripeHeight = 40;

        this.ctx.save();
        this.ctx.globalAlpha = 0.3;

        // Draw checkered pattern
        for (let y = 0; y < lineHeight; y += stripeHeight) {
          const offset = (Math.floor(y / stripeHeight) % 2) * stripeWidth;
          for (let dx = 0; dx < stripeWidth * 2; dx += stripeWidth) {
            if ((dx / stripeWidth) % 2 === 0) {
              this.ctx.fillStyle = '#ffffff';
            } else {
              this.ctx.fillStyle = '#000000';
            }
            this.ctx.fillRect(x + dx - offset, y, stripeWidth, stripeHeight);
          }
        }

        // Glowing edge
        this.ctx.globalAlpha = 0.4;
        this.ctx.strokeStyle = '#00ffff';
        this.ctx.lineWidth = 3;
        this.ctx.shadowColor = '#00ffff';
        this.ctx.shadowBlur = 20;
        this.ctx.beginPath();
        this.ctx.moveTo(x, 0);
        this.ctx.lineTo(x, lineHeight);
        this.ctx.stroke();

        this.ctx.restore();
      }
    }

    class PolyRunner {
      constructor(x, y, color) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.speed = 1.2 + Math.random() * 0.6;
        this.animTime = Math.random() * 100;

        // Random letter
        const letters = ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'];
        this.letter = letters[Math.floor(Math.random() * letters.length)];
        this.letterChangeTime = Date.now() + 2000 + Math.random() * 3000;
      }

      update(width) {
        this.x += this.speed;

        if (this.x > width + 100) {
          this.x = -100;
        }

        this.animTime += 0.015;

        if (Date.now() > this.letterChangeTime) {
          const letters = ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'];
          this.letter = letters[Math.floor(Math.random() * letters.length)];
          this.letterChangeTime = Date.now() + 2000 + Math.random() * 3000;
        }
      }

      draw(ctx) {
        const phase = (this.animTime) % 1;
        this.drawDetailedRunner(ctx, this.x, this.y, this.color, phase, this.letter);
      }

      drawDetailedRunner(ctx, x, y, color, phase, letter) {
        const S = 1.2;
        const legSwing = Math.sin(phase * Math.PI * 2) * 35;
        const legOpp = Math.sin(phase * Math.PI * 2 + Math.PI) * 35;
        const armSwing = Math.sin(phase * Math.PI * 2 + Math.PI) * 40;
        const armOpp = Math.sin(phase * Math.PI * 2) * 40;
        const lean = 18;
        const bob = Math.sin(phase * Math.PI * 2) * 3;

        y = y + bob;

        const torsoW = 24 * S;
        const torsoH = 42 * S;
        const headW = 20 * S;
        const headH = 24 * S;
        const torsoTop = y - torsoH - 12;
        const torsoBot = y - 12;

        ctx.save();
        ctx.globalAlpha = 0.7;
        ctx.shadowColor = color;
        ctx.shadowBlur = 20;

        const light = this.lightenColor(color, 30);
        const dark = this.darkenColor(color, 30);
        const shade = this.darkenColor(color, 50);

        // Draw back limbs
        this.drawLeg(ctx, x, torsoBot, legOpp - 10, -8, dark, shade, true, S);
        this.drawArm(ctx, x + lean, torsoTop + 14, armOpp - 35, -14, dark, shade, true, S);

        // Torso
        this.poly([
          {x: x - torsoW/2 + lean, y: torsoTop},
          {x: x + torsoW/2 + lean, y: torsoTop},
          {x: x + torsoW/2 - 2, y: torsoBot},
          {x: x - torsoW/2 - 2, y: torsoBot}
        ], color, ctx);

        this.poly([
          {x: x + torsoW/2 + lean, y: torsoTop},
          {x: x + torsoW/2 + lean + 10, y: torsoTop + 6},
          {x: x + torsoW/2 + 8, y: torsoBot + 6},
          {x: x + torsoW/2 - 2, y: torsoBot}
        ], dark, ctx);

        // Head
        const headX = x + lean + 10;
        const headY = torsoTop - headH - 2;

        this.poly([
          {x: headX - headW/2, y: headY + 4},
          {x: headX + headW/2, y: headY},
          {x: headX + headW/2 + 2, y: headY + headH - 4},
          {x: headX, y: headY + headH},
          {x: headX - headW/2 - 2, y: headY + headH - 4}
        ], light, ctx);

        this.poly([
          {x: headX + headW/2, y: headY},
          {x: headX + headW/2 + 12, y: headY + 4},
          {x: headX + headW/2 + 10, y: headY + headH - 2},
          {x: headX + headW/2 + 2, y: headY + headH - 4}
        ], dark, ctx);

        this.poly([
          {x: headX - headW/2, y: headY + 4},
          {x: headX + headW/2, y: headY},
          {x: headX + headW/2 + 12, y: headY + 4},
          {x: headX, y: headY + 8}
        ], color, ctx);

        // Draw front limbs
        this.drawLeg(ctx, x, torsoBot, legSwing + 10, 8, color, dark, false, S);
        this.drawArm(ctx, x + lean, torsoTop + 14, armSwing + 20, -10, color, dark, false, S);

        ctx.restore();

        // Draw letter above head
        const letterY = y - torsoH - headH - 40 - Math.sin(Date.now() * 0.003 + x * 0.01) * 10;
        ctx.save();
        ctx.globalAlpha = 0.9;
        ctx.shadowColor = color;
        ctx.shadowBlur = 30;
        ctx.fillStyle = color;
        ctx.font = 'bold 36px Orbitron';
        ctx.textAlign = 'center';
        ctx.fillText(letter, x, letterY);
        ctx.restore();
      }

      poly(points, fill, ctx) {
        ctx.fillStyle = fill;
        ctx.beginPath();
        ctx.moveTo(points[0].x, points[0].y);
        for (let i = 1; i < points.length; i++) {
          ctx.lineTo(points[i].x, points[i].y);
        }
        ctx.closePath();
        ctx.fill();
      }

      drawLeg(ctx, x, hipY, angle, offsetX, color1, color2, isBack, S) {
        const a = angle * Math.PI / 180;
        const thighLen = 30 * S;
        const shinLen = 30 * S;

        const hipX = x + offsetX;
        const kneeX = hipX + Math.sin(a) * thighLen;
        const kneeY = hipY + Math.cos(a) * thighLen;

        const shinA = a - 0.6;
        const ankleX = kneeX + Math.sin(shinA) * shinLen;
        const ankleY = kneeY + Math.cos(shinA) * shinLen;

        const legW = 11;
        const kneeW = 13;

        if (isBack) ctx.globalAlpha = 0.4;

        // Thigh
        this.poly([
          {x: hipX - legW/2, y: hipY},
          {x: hipX + legW/2, y: hipY},
          {x: kneeX + legW/2, y: kneeY},
          {x: kneeX - legW/2, y: kneeY}
        ], color1, ctx);

        // Knee joint
        const kneePts = [];
        for (let i = 0; i < 6; i++) {
          const ang = (i / 6) * Math.PI * 2;
          kneePts.push({
            x: kneeX + Math.cos(ang) * kneeW/2,
            y: kneeY + Math.sin(ang) * kneeW/2
          });
        }
        this.poly(kneePts, this.lightenColor(color1, 20), ctx);

        // Shin
        this.poly([
          {x: kneeX - (legW-2)/2, y: kneeY},
          {x: kneeX + (legW-2)/2, y: kneeY},
          {x: ankleX + (legW-2)/2, y: ankleY},
          {x: ankleX - (legW-2)/2, y: ankleY}
        ], color2, ctx);

        // Foot
        this.poly([
          {x: ankleX - 8, y: ankleY},
          {x: ankleX + 18, y: ankleY},
          {x: ankleX + 20, y: ankleY + 10},
          {x: ankleX - 6, y: ankleY + 10}
        ], this.darkenColor(color1, 60), ctx);

        if (isBack) ctx.globalAlpha = 1.0;
      }

      drawArm(ctx, shoulderX, shoulderY, angle, offsetX, color1, color2, isBack, S) {
        const a = angle * Math.PI / 180;
        const upperLen = 24 * S;
        const lowerLen = 22 * S;

        shoulderX = shoulderX + offsetX;
        const elbowX = shoulderX + Math.sin(a) * upperLen;
        const elbowY = shoulderY + Math.cos(a) * upperLen;

        const foreA = a + 0.8;
        const handX = elbowX + Math.sin(foreA) * lowerLen;
        const handY = elbowY + Math.cos(foreA) * lowerLen;

        const armW = 9;
        const elbowW = 11;

        if (isBack) ctx.globalAlpha = 0.4;

        // Upper arm
        this.poly([
          {x: shoulderX - armW/2, y: shoulderY},
          {x: shoulderX + armW/2, y: shoulderY},
          {x: elbowX + armW/2, y: elbowY},
          {x: elbowX - armW/2, y: elbowY}
        ], color1, ctx);

        // Elbow joint
        const elbowPts = [];
        for (let i = 0; i < 6; i++) {
          const ang = (i / 6) * Math.PI * 2;
          elbowPts.push({
            x: elbowX + Math.cos(ang) * elbowW/2,
            y: elbowY + Math.sin(ang) * elbowW/2
          });
        }
        this.poly(elbowPts, this.lightenColor(color1, 20), ctx);

        // Forearm
        this.poly([
          {x: elbowX - (armW-2)/2, y: elbowY},
          {x: elbowX + (armW-2)/2, y: elbowY},
          {x: handX + (armW-2)/2, y: handY},
          {x: handX - (armW-2)/2, y: handY}
        ], color2, ctx);

        // Hand
        this.poly([
          {x: handX - 7, y: handY},
          {x: handX + 7, y: handY},
          {x: handX + 9, y: handY + 7},
          {x: handX, y: handY + 11},
          {x: handX - 9, y: handY + 7}
        ], this.lightenColor(color1, 10), ctx);

        if (isBack) ctx.globalAlpha = 1.0;
      }

      lightenColor(color, percent) {
        const num = parseInt(color.replace("#",""), 16);
        const amt = Math.round(2.55 * percent);
        const R = Math.min(255, (num >> 16) + amt);
        const G = Math.min(255, (num >> 8 & 0x00FF) + amt);
        const B = Math.min(255, (num & 0x0000FF) + amt);
        return "#" + (0x1000000 + R*0x10000 + G*0x100 + B).toString(16).slice(1);
      }

      darkenColor(color, percent) {
        const num = parseInt(color.replace("#",""), 16);
        const amt = Math.round(2.55 * percent);
        const R = Math.max(0, (num >> 16) - amt);
        const G = Math.max(0, (num >> 8 & 0x00FF) - amt);
        const B = Math.max(0, (num & 0x0000FF) - amt);
        return "#" + (0x1000000 + R*0x10000 + G*0x100 + B).toString(16).slice(1);
      }
    }

    // Landing page script
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize wireframe background
      const bgContainer = document.getElementById('wireframe-bg-container');
      if (bgContainer) {
        new WireframeBackground('wireframe-bg-container');
      }

      // Fetch player count and leaderboard
      fetchPlayerCount();
      fetchLeaderboard();

      // Update every 10 seconds
      setInterval(fetchPlayerCount, 10000);
      setInterval(fetchLeaderboard, 30000);

      // Setup fade transition for PLAY button
      const playBtn = document.getElementById('playBtn');
      const fadeOverlay = document.getElementById('fade-overlay');

      if (playBtn && fadeOverlay) {
        playBtn.addEventListener('click', (e) => {
          e.preventDefault();

          // Trigger fade out
          fadeOverlay.classList.add('active');

          // Redirect after fade completes
          setTimeout(() => {
            window.location.href = 'modes.html';
          }, 800); // Match the CSS transition duration
        });
      }
    });

    async function fetchPlayerCount() {
      try {
        const response = await fetch('/health');
        const data = await response.json();

        const playerCountElement = document.getElementById('players-online');
        if (playerCountElement) {
          playerCountElement.textContent = data.players || 0;
        }
      } catch (error) {
        console.log('Could not fetch player count:', error);
        const playerCountElement = document.getElementById('players-online');
        if (playerCountElement) {
          playerCountElement.textContent = '--';
        }
      }
    }

    async function fetchLeaderboard() {
      try {
        const response = await fetch('/leaderboard');
        const data = await response.json();

        if (data && data.leaderboard && Array.isArray(data.leaderboard)) {
          updateLeaderboard(data.leaderboard);
        }
      } catch (error) {
        console.log('Could not fetch leaderboard:', error);
      }
    }

    function updateLeaderboard(leaderboardData) {
      const entriesContainer = document.getElementById('leaderboard-entries');
      if (!entriesContainer) return;

      entriesContainer.innerHTML = '';

      leaderboardData.slice(0, 10).forEach((player, index) => {
        const entry = document.createElement('div');
        entry.className = 'leaderboard-entry';
        
        if (index === 0) entry.classList.add('lb-gold');
        else if (index === 1) entry.classList.add('lb-silver');
        else if (index === 2) entry.classList.add('lb-bronze');

        let rankContent = '';
        if (index < 3) {
          const colors = ['#FFD700', '#C0C0C0', '#CD7F32'];
          rankContent = `
            <svg viewBox="0 0 30 30" width="24" height="24" class="rank-icon">
              <polygon points="15,3 18,12 27,12 20,17 23,26 15,20 7,26 10,17 3,12 12,12" fill="${colors[index]}"/>
            </svg>
          `;
        } else {
          rankContent = index + 1;
        }

        entry.innerHTML = `
          <div class="lb-col lb-rank">${rankContent}</div>
          <div class="lb-col lb-player">${escapeHtml(player.username || 'Anonymous')}</div>
          <div class="lb-col lb-wins">${player.wins || 0}</div>
          <div class="lb-col lb-wpm">${player.wpm || 0}</div>
        `;

        entriesContainer.appendChild(entry);
      });
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
  </script>

  <!-- Socket.IO for online player count -->
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

  <script>
    // Connect to server to track online players
    (function() {
      const serverUrl = 'https://polyracer-production.up.railway.app';
      const playersOnlineEl = document.getElementById('players-online');

      // Generate or get stored anonymous ID
      let anonymousId = localStorage.getItem('anonymousId');
      if (!anonymousId) {
        anonymousId = 'Guest_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('anonymousId', anonymousId);
      }

      try {
        const socket = io(serverUrl, {
          transports: ['websocket', 'polling'],
          reconnection: true,
          reconnectionAttempts: 3
        });

        socket.on('connect', () => {
          console.log('[HOME] Connected to server:', socket.id);

          // Register as a visitor
          socket.emit('player:register', {
            name: anonymousId,
            isVisitor: true
          });
        });

        // Update online count
        socket.on('players:online', (data) => {
          if (playersOnlineEl && data.count !== undefined) {
            playersOnlineEl.textContent = data.count;
            console.log('[HOME] Players online:', data.count);
          }
        });

        socket.on('connect_error', (error) => {
          console.log('[HOME] Connection error, showing offline');
          if (playersOnlineEl) {
            playersOnlineEl.textContent = '---';
          }
        });

        socket.on('disconnect', () => {
          console.log('[HOME] Disconnected from server');
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
          if (socket && socket.connected) {
            socket.disconnect();
          }
        });

      } catch (error) {
        console.error('[HOME] Failed to connect:', error);
        if (playersOnlineEl) {
          playersOnlineEl.textContent = '---';
        }
      }
    })();
  </script>
</body>
</html>
